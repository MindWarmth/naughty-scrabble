(this["webpackJsonpnaughty-scrabble"]=this["webpackJsonpnaughty-scrabble"]||[]).push([[0],{181:function(e,t,n){},310:function(e,t,n){},311:function(e,t,n){},312:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n(0),o=n.n(a),r=n(9),i=n.n(r),s=(n(181),n(13)),l=n(18),j=n(12),d=n(165),b=n(366),u=Object(a.createContext)(),h=n(350),O=function(){return Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Welcome to Naughty Scrabble!"}),Object(c.jsx)("p",{children:"Press the button below to create a new game."}),Object(c.jsx)(h.a,{component:l.b,to:"/create",color:"primary",variant:"contained",size:"large",children:"Create new game"}),Object(c.jsx)("p",{children:"To join an existed game you need a link."})]})},x=n(104),f=n.n(x),m=n(155),p=n(166),g=n(354),v=n(368),w=n(367),y=n(156),C=n.n(y),D=function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],o=t[1],r=Object(a.useContext)(u),i=r.publicURL,j=r.setGameID,d=r.setDictionary,b=Boolean(window.Worker),O=new Worker("".concat(i,"/workers/dictionary.js")),x=function(){var e=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.readText();case 3:t=e.sent,o(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Failed to read clipboard");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Create a new game"}),Object(c.jsxs)(g.a,{container:!0,spacing:3,children:[Object(c.jsx)(g.a,{item:!0,xs:6,children:Object(c.jsx)(w.a,{label:"Insert text which will be used as dictionary",placeholder:"Put you text here",multiline:!0,rows:4,fullWidth:!0,variant:"outlined",value:n,onChange:function(e){var t=e.currentTarget.value;return o(t)}})}),Object(c.jsx)(g.a,{item:!0,xs:6,children:Object(c.jsxs)(h.a,{variant:"contained",color:"secondary",startIcon:Object(c.jsx)(C.a,{}),onClick:x,children:["Paste",Object(c.jsx)(v.a,{xsDown:!0,children:" from clipboard"})]})}),Object(c.jsx)(g.a,{item:!0,xs:12,children:Object(c.jsx)(h.a,{component:l.b,disabled:!n,onClick:function(){j(Object(p.a)()),b&&(O.postMessage(n),O.onmessage=function(e){var t=e.data;d(t)})},to:"/invite",color:"primary",variant:"contained",size:"large",children:"Proceed"})})]})]})},S=n(160),k=n.n(S),I=n(157),T=n.n(I),N=n(158),R=n.n(N),P=n(159),z=n.n(P),A=n(357),E=n(167),M=n(51),L="dictionary",W="message",_="play",J="LEAVE",U=Object(a.createContext)({open:function(){},onMessage:function(){},sendMessage:function(){}}),F=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.msRTCPeerConnection,G=window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription||window.msRTCSessionDescription,B={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},H={},V="Alice",Y=function(e){var t=Object(a.useContext)(u).setUser,n=Object(a.useState)(),o=Object(s.a)(n,2),r=o[0],i=o[1],l=Object(a.useState)([]),j=Object(s.a)(l,2),d=j[0],b=j[1],h=Object(a.useState)(),O=Object(s.a)(h,2),x=O[0],f=O[1];Object(a.useEffect)((function(){x&&(d.forEach((function(e){e&&e(x)})),f(null))}),[x]);var m={open:function(n){return function(n){return new Promise((function(c,a){var o,r,s=null,l="".concat(V,"_").concat(Math.floor(1e4*Math.random()));function j(){return(o=new F(B,H)).onicecandidate=function(e){o&&e&&e.candidate&&d("candidate",e.candidate)},(r=o.createDataChannel("datachannel",{reliable:!1})).onopen=function(){console.log("%cDATACHANNEL OPENED","color: green"),t(l),i(r),c()},r.onclose=function(){console.log("%cDATACHANNEL CLOSED","color: red")},r.onerror=function(){console.log("%cDATACHANNEL ERROR","color: red")},o.ondatachannel=function(e){e.channel.onopen=function(){},e.channel.onmessage=function(e){f(JSON.parse(e.data))}},o}function d(e,t){var c={from:l,gameID:n,action:e,data:t};s.send(JSON.stringify(c))}function b(e){var t=j();t.setRemoteDescription(new G(e)).catch((function(e){console.log(e)}));var n={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};t.createAnswer(n).then((function(e){return t.setLocalDescription(e).then((function(){d("answer",e)}))}),(function(e){console.log(e)}))}function u(e){o.setRemoteDescription(new G(e))}function h(e){o.addIceCandidate(new RTCIceCandidate(e)).catch((function(e){console.log(e)}))}(s=new WebSocket(e.url)).onopen=function(e){console.log("%cWebsocket opened","color: gray"),j();var t={offerToReceiveAudio:!0,offerToReceiveVideo:!1};o.createOffer(t).then((function(e){o.setLocalDescription(e),d("offer",e)}),(function(e){console.log(e)}))},s.onclose=function(e){console.log("%cWebsocket closed","color: gray")},s.onerror=function(e){console.log("%cWebsocket error","color: red")},s.onmessage=function(e){var t=JSON.parse(e.data);t.gameID===n&&t.from!==l&&("candidate"===t.action?h(t.data):"offer"===t.action?b(t.data):"answer"===t.action&&u(t.data))}}))}(n)},onMessage:function(e){return function(e){console.log("messageHandlers",d),b((function(t){return[].concat(Object(M.a)(t),[e])}))}(e)},sendMessage:function(e){return function(e){r&&r.send(JSON.stringify(e))}(e)}};return Object(c.jsx)(U.Provider,Object(E.a)({value:m},e))},Z=function(){return Object(a.useContext)(U)},q="ready",K="success",Q="failure",X=function(){var e=Object(a.useState)(q),t=Object(s.a)(e,2),n=t[0],o=t[1],r=Object(a.useState)(!1),i=Object(s.a)(r,2),d=i[0],b=i[1],O=Object(a.useContext)(u).gameID,x=Z(),f=Object(j.g)(),m="".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname,"#"),p="".concat(m,"/join/").concat(O),w="/game/".concat(O);return Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Share link"}),Object(c.jsx)("p",{children:"Share this link with your friend to play together:"}),Object(c.jsxs)(g.a,{container:!0,spacing:3,children:[Object(c.jsx)(g.a,{item:!0,xs:12,children:Object(c.jsx)("code",{children:"".concat(p)})}),Object(c.jsx)(g.a,{item:!0,xs:12,children:Object(c.jsxs)(g.a,{container:!0,children:[navigator.clipboard&&Object(c.jsx)(g.a,{item:!0,xs:6,children:Object(c.jsxs)(h.a,{color:"secondary",variant:"outlined",onClick:function(){if(n===q)try{navigator.clipboard.writeText(p).then((function(){return o(K)})).catch((function(){return o(Q)}))}catch(e){console.log("Failed to write to clipboard")}},size:"large",startIcon:n===q?Object(c.jsx)(T.a,{}):n===K?Object(c.jsx)(R.a,{}):Object(c.jsx)(z.a,{}),children:["Copy",Object(c.jsx)(v.a,{xsDown:!0,children:" to cliboard"})]})}),navigator.share&&Object(c.jsx)(g.a,{item:!0,xs:6,children:Object(c.jsx)(h.a,{color:"secondary",variant:"outlined",onClick:function(){navigator.share({url:"".concat(p),title:"SCRABBLE",text:"Invite your friend to the game!"}).then((function(){return console.log("Invite sent!")})).catch((function(e){return console.log("".concat(e))}))},size:"large",startIcon:Object(c.jsx)(k.a,{}),children:"Share"})})]})}),Object(c.jsx)(g.a,{item:!0,xs:6,children:Object(c.jsxs)(h.a,{color:"primary",variant:"contained",onClick:function(){b(!0),x.open(O).then((function(){f.push(w)})).catch((function(){b(!1)}))},disabled:d,size:"large",startIcon:d&&Object(c.jsx)(A.a,{size:16}),children:["Start",Object(c.jsx)(v.a,{xsDown:!0,children:" game"})]})}),Object(c.jsx)(g.a,{item:!0,xs:6,children:Object(c.jsxs)(h.a,{component:l.b,to:"/create",color:"primary",variant:"outlined",size:"large",children:[Object(c.jsx)(v.a,{xsDown:!0,children:"Create new game"}),Object(c.jsx)(v.a,{smUp:!0,children:"Create"})]})})]})]})},$=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],o=t[1],r=Object(j.g)(),i=Object(j.h)().gameID,d=Object(a.useContext)(u).setGameID,b="/game/".concat(i),O=Z();return Object(a.useEffect)((function(){d(i)}),[i]),Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Join to the game"}),Object(c.jsxs)(g.a,{container:!0,spacing:3,children:[Object(c.jsx)(g.a,{item:!0,xs:12,children:Object(c.jsxs)("code",{children:["Game ID: ",i]})}),Object(c.jsx)(g.a,{item:!0,xs:6,children:Object(c.jsx)(h.a,{variant:"contained",color:"primary",onClick:function(){o(!0),O.open(i).then((function(){r.push(b)})).catch((function(){o(!1)}))},size:"large",disabled:n,startIcon:n&&Object(c.jsx)(A.a,{size:16}),children:"Join game"})}),Object(c.jsx)(g.a,{item:!0,xs:6,children:Object(c.jsxs)(h.a,{component:l.b,to:"/create",color:"primary",variant:"outlined",size:"large",children:["Create",Object(c.jsx)(v.a,{xsDown:!0,children:" new game"})]})})]})]})},ee=n(161),te=n.n(ee),ne=n(162),ce=n.n(ne),ae=n(163),oe=n.n(ae),re=(n(310),new Array(10).fill({})),ie=new Array(10).fill({});var se=function(e){var t=e.fieldsData,n=e.onChange,a=e.canPlay;return Object(c.jsx)("div",{className:oe()("board",{"board--active":a}),children:re.map((function(e,o){return Object(c.jsx)("div",{className:"board__row",children:ie.map((function(e,r){var i,s,l=ce()("".concat(o,".").concat(r),t);return Object(c.jsx)("div",{className:"board__col",children:a&&!l?Object(c.jsx)("input",{className:"board__cell",value:"",onChange:(i=o,s=r,function(e){var t=e.currentTarget.value,c=String(t).toUpperCase().match(/([A-Z])/);c&&c.length&&n({row:i,col:s,letter:c[0]})})}):Object(c.jsx)("div",{className:"board__cell",children:l})},"col-".concat(r))}))},"row-".concat(o))}))})},le=n(358),je=n(356),de=n(359),be=n(369),ue=Object(le.a)((function(e){return{root:{backgroundColor:e.palette.background.paper,maxHeight:120,overflow:"auto"}}}));var he=function(){var e=ue(),t=Object(a.useContext)(u).user,n=Z(),o=Object(a.useState)([]),r=Object(s.a)(o,2),i=r[0],l=r[1];return Object(a.useEffect)((function(){n.onMessage((function(e){switch(e.type){case W:l((function(t){return[e.data].concat(Object(M.a)(t))}));break;case _:l((function(t){return["Oponent: ".concat(e.data.previousStep.letter)].concat(Object(M.a)(t))}))}e.type})),setTimeout((function(){n.sendMessage({type:W,data:"".concat(t," joined")})}),1e3)}),[]),Object(c.jsx)(je.a,{className:e.root,component:"nav",children:i.map((function(e,t){return Object(c.jsx)(de.a,{children:Object(c.jsx)(be.a,{primary:e})},t)}))})},Oe=n(361),xe=n(362),fe=n(364),me=n(360),pe=n(363),ge=n(355);var ve=function(){return Object(c.jsx)(me.a,{component:ge.a,children:Object(c.jsx)(Oe.a,{"aria-label":"simple table",size:"small",children:Object(c.jsxs)(xe.a,{children:[Object(c.jsxs)(pe.a,{children:[Object(c.jsx)(fe.a,{component:"th",scope:"row",children:"Player #1 last score:"}),Object(c.jsx)(fe.a,{align:"right",children:"5"})]}),Object(c.jsxs)(pe.a,{children:[Object(c.jsx)(fe.a,{component:"th",scope:"row",children:"Player #1 total score:"}),Object(c.jsx)(fe.a,{align:"right",children:"47"})]}),Object(c.jsxs)(pe.a,{children:[Object(c.jsx)(fe.a,{component:"th",scope:"row",children:"Player #2 last score:"}),Object(c.jsx)(fe.a,{align:"right",children:"2"})]}),Object(c.jsxs)(pe.a,{children:[Object(c.jsx)(fe.a,{component:"th",scope:"row",children:"Player #2 total score:"}),Object(c.jsx)(fe.a,{align:"right",children:"54"})]})]})})})},we=n(365),ye=n(164),Ce=n.n(ye),De=Object(le.a)((function(e){return{btn:{fontSize:"11px",margin:"0 1px"}}}));var Se=function(){var e=De(),t=Object(j.g)(),n=Object(a.useContext)(u),o=n.setGameID,r=n.setDictionary,i=n.setUser,s=Z();return Object(a.useEffect)((function(){s.onMessage((function(e){e.type===J&&(o(null),r([]),i(null),t.push("/"))}))}),[]),Object(c.jsxs)("div",{children:[Object(c.jsx)(h.a,{variant:"contained",size:"small",color:"primary",className:e.btn,children:"Submit"}),Object(c.jsx)(h.a,{variant:"contained",size:"small",color:"secondary",className:e.btn,children:"Pass"}),Object(c.jsx)(h.a,{variant:"contained",size:"small",className:e.btn,children:"Reset"}),Object(c.jsx)(h.a,{variant:"outlined",size:"small",className:e.btn,children:"Swap"}),Object(c.jsx)(we.a,{"aria-label":"Leave",component:"span",size:"small",onClick:function(){s.sendMessage({type:J}),o(null),r([]),i(null),t.push("/")},children:Object(c.jsx)(Ce.a,{})})]})},ke=function(){var e=Object(j.h)(),t=Object(a.useContext)(u),n=t.gameID,o=t.dictionary,r=t.setDictionary,i=t.user,l=Object(a.useState)({}),d=Object(s.a)(l,2),b=d[0],h=d[1],O=Object(a.useState)(!0),x=Object(s.a)(O,2),f=x[0],m=x[1],p=Z();if(Object(a.useEffect)((function(){p.onMessage((function(e){var t=e.type,n=e.data;switch(t){case L:r(n);break;case _:m(!0),h(n.fieldsData)}})),o&&p.sendMessage({type:L,data:o})}),[]),!n&&e.gameID)return Object(c.jsx)(j.a,{to:"/join/".concat(e.gameID)});return Object(c.jsxs)("div",{children:[Object(c.jsxs)("h1",{children:["Game ID: ",Object(c.jsx)("code",{children:n})]}),Object(c.jsxs)("p",{children:["user: ",Object(c.jsx)("code",{children:i})]}),Object(c.jsxs)(g.a,{container:!0,spacing:3,children:[Object(c.jsx)(g.a,{item:!0,xs:12,sm:8,children:Object(c.jsx)(se,{fieldsData:b,onChange:function(e){var t=e.row,n=e.col,c=e.letter,a=te()("".concat(t,".").concat(n),c,b);m(!1),h(a),p.sendMessage({type:_,data:{previousStep:{row:t,col:n,letter:c},fieldsData:a}})},canPlay:f})}),Object(c.jsx)(g.a,{item:!0,xs:12,sm:4,children:Object(c.jsxs)(g.a,{container:!0,direction:"column",alignItems:"stretch",children:[Object(c.jsx)(g.a,{item:!0,xs:12,children:Object(c.jsx)("p",{children:f?"You turn!":Object(c.jsx)("small",{children:"Wait for the opponent..."})})}),Object(c.jsx)(v.a,{xsDown:!0,children:Object(c.jsx)(g.a,{item:!0,xs:12,children:Object(c.jsx)(he,{})})}),Object(c.jsx)(g.a,{item:!0,xs:12,children:Object(c.jsx)(ve,{})}),Object(c.jsx)(g.a,{item:!0,xs:12,children:Object(c.jsx)(Se,{})})]})}),o&&o.length&&Object(c.jsx)(g.a,{item:!0,xs:12,children:Object(c.jsx)("code",{children:o.map((function(e){return"".concat(e,", ")}))})})]})]})};n(311);var Ie=function(){var e=Object(d.a)({palette:{type:"dark",primary:{light:"#ff7961",main:"#f44336",dark:"#ba000d",contrastText:"#fff"}}}),t=Object(a.useState)(),n=Object(s.a)(t,2),o=n[0],r=n[1],i=Object(a.useState)(),h=Object(s.a)(i,2),x=h[0],f=h[1],m=Object(a.useState)(),p=Object(s.a)(m,2),g=p[0],v=p[1];return Object(c.jsx)(l.a,{children:Object(c.jsx)(u.Provider,{value:{publicURL:window.publicURL||"",gameID:o,setGameID:r,dictionary:x,setDictionary:f,user:g,setUser:v},children:Object(c.jsx)(Y,{url:"wss://ice-server.app.html.wtf",children:Object(c.jsx)(b.a,{theme:e,children:Object(c.jsx)("div",{className:"app",children:Object(c.jsxs)(j.d,{children:[Object(c.jsx)(j.b,{path:"/create",children:Object(c.jsx)(D,{})}),Object(c.jsx)(j.b,{path:"/invite",children:Object(c.jsx)(X,{})}),Object(c.jsx)(j.b,{path:"/join/:gameID",children:Object(c.jsx)($,{})}),Object(c.jsx)(j.b,{path:"/game/:gameID",children:Object(c.jsx)(ke,{})}),Object(c.jsx)(j.b,{path:"/",children:Object(c.jsx)(O,{})})]})})})})})})},Te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,370)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),o(e),r(e)}))};i.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(Ie,{})}),document.getElementById("root")),Te()}},[[312,1,2]]]);
//# sourceMappingURL=main.8db5b3c9.chunk.js.map