(this["webpackJsonpnaughty-scrabble"]=this["webpackJsonpnaughty-scrabble"]||[]).push([[0],{79:function(e,n,t){},87:function(e,n,t){},88:function(e,n,t){},89:function(e,n,t){},90:function(e,n,t){},91:function(e,n,t){},92:function(e,n,t){"use strict";t.r(n);var c=t(2),a=t(0),o=t.n(a),i=t(9),r=t.n(i),s=(t(79),t(14)),l=t(20),j=t(12),d=t(64),b=t(147),u=Object(a.createContext)(),h=t(130),O=function(){return Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Welcome to Naughty Scrabble!"}),Object(c.jsx)("p",{children:"Press the button below to create a new game."}),Object(c.jsx)(h.a,{component:l.b,to:"/create",color:"primary",variant:"contained",size:"large",children:"New game"}),Object(c.jsx)("p",{children:"To join an existed game you need a link."})]})},f=t(49),x=t.n(f),m=t(58),p=t(65),g=t(134),v=t(148),w=t(59),C=t.n(w),y=function(){var e=Object(a.useState)(""),n=Object(s.a)(e,2),t=n[0],o=n[1],i=Object(a.useContext)(u).setGameID,r=function(){var e=Object(m.a)(x.a.mark((function e(){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.readText();case 3:n=e.sent,o(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Failed to read clipboard");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Create new game"}),Object(c.jsxs)(g.a,{container:!0,spacing:3,children:[Object(c.jsx)(g.a,{item:!0,xs:6,children:Object(c.jsx)(v.a,{label:"Text",placeholder:"Put you text here",multiline:!0,rows:4,fullWidth:!0,variant:"outlined",value:t,onChange:function(e){console.log(e)}})}),Object(c.jsx)(g.a,{item:!0,xs:6,children:Object(c.jsx)(h.a,{variant:"contained",color:"secondary",startIcon:Object(c.jsx)(C.a,{}),onClick:r,children:"Paste from clipboard"})}),Object(c.jsx)(g.a,{item:!0,xs:12,children:Object(c.jsx)(h.a,{component:l.b,onClick:function(){return i(Object(p.a)())},to:"/invite",color:"primary",variant:"contained",size:"large",children:"Proceed"})})]})]})},D=t(137),N=t(60),S=t.n(N),R=t(61),T=t.n(R),k=t(62),P=t.n(k),I=t(63),A=t.n(I),z=t(138),E=t(66),L=Object(a.createContext)({open:function(){},onMessage:function(){},sendMessage:function(){},user:""}),B=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.msRTCPeerConnection,M=window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription||window.msRTCSessionDescription,F={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},J={},W="Alice",G=function(e){var n=Object(a.useState)(null),t=Object(s.a)(n,2),o=t[0],i=t[1],r=Object(a.useState)(),l=Object(s.a)(r,2),j=l[0],d=l[1],b=Object(a.useState)(),u=Object(s.a)(b,2),h=u[0],O=u[1],f={open:function(n){return function(n){return new Promise((function(t,c){var a,o,r=null,s="".concat(W,"_").concat(Math.floor(1e4*Math.random()));function l(){return(a=new B(F,J)).onicecandidate=function(e){a&&e&&e.candidate&&j("candidate",e.candidate)},(o=a.createDataChannel("datachannel",{reliable:!1})).onopen=function(){console.log("%cDATACHANNEL OPENED","color: green"),i(s),d(o),setTimeout((function(){t()}),500)},o.onclose=function(){console.log("%cDATACHANNEL CLOSED","color: red")},o.onerror=function(){console.log("%cDATACHANNEL ERROR","color: red")},a.ondatachannel=function(e){e.channel.onopen=function(){O(e.channel)}},a}function j(e,t){var c={from:s,gameID:n,action:e,data:t};r.send(JSON.stringify(c))}function b(e){var n=l();n.setRemoteDescription(new M(e)).catch((function(e){console.log(e)}));var t={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};n.createAnswer(t).then((function(e){return n.setLocalDescription(e).then((function(){j("answer",e)}))}),(function(e){console.log(e)}))}function u(e){a.setRemoteDescription(new M(e))}function h(e){a.addIceCandidate(new RTCIceCandidate(e)).catch((function(e){console.log(e)}))}(r=new WebSocket(e.url)).onopen=function(e){console.log("%cWebsocket opened","color: gray"),l();var n={offerToReceiveAudio:!0,offerToReceiveVideo:!1};a.createOffer(n).then((function(e){a.setLocalDescription(e),j("offer",e)}),(function(e){console.log(e)}))},r.onclose=function(e){console.log("%cWebsocket closed","color: gray")},r.onerror=function(e){console.log("%cWebsocket error","color: red")},r.onmessage=function(e){var t=JSON.parse(e.data);t.gameID===n&&t.from!==s&&("candidate"===t.action?h(t.data):"offer"===t.action?b(t.data):"answer"===t.action&&u(t.data))}}))}(n)},onMessage:function(e){return function(e){h&&(h.onmessage=function(n){console.log("%cMessage received:\n".concat(n.data),"font-weight: bold"),e&&e(n.data)})}(e)},sendMessage:function(e){return function(e){j&&j.send(e)}(e)},user:o};return Object(c.jsx)(L.Provider,Object(E.a)({value:f},e))},H=function(){return Object(a.useContext)(L)},V="ready",_="success",q="failure",K=function(){var e=Object(a.useState)(V),n=Object(s.a)(e,2),t=n[0],o=n[1],i=Object(a.useState)(!1),r=Object(s.a)(i,2),l=r[0],d=r[1],b=Object(a.useContext)(u).gameID,O=H(),f=Object(j.f)(),x="".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname,"/#"),m="".concat(x,"/join/").concat(b),p="/game/".concat(b);return Object(c.jsxs)("div",{children:[Object(c.jsx)("p",{children:"Share this link with your friend to play the SRRRABBBLE:"}),Object(c.jsx)("code",{className:"multiline-code",children:"".concat(m)}),navigator.share&&Object(c.jsx)("p",{children:Object(c.jsx)(D.a,{onClick:function(){navigator.share({url:"".concat(m),title:"SCRABBLE",text:"Invite your friend to the game!"}).then((function(){return console.log("Invite sent!")})).catch((function(e){return console.log("".concat(e))}))},children:Object(c.jsx)(S.a,{})})}),navigator.clipboard&&Object(c.jsx)("p",{children:Object(c.jsx)(D.a,{onClick:function(){if(t===V)try{navigator.clipboard.writeText(m).then((function(){return o(_)})).catch((function(){return o(q)}))}catch(e){console.log("Failed to write to clipboard")}},"aria-label":"paste from clipboard",component:"span",children:t===V?Object(c.jsx)(T.a,{}):t===_?Object(c.jsx)(P.a,{}):Object(c.jsx)(A.a,{})})}),Object(c.jsx)("p",{children:Object(c.jsx)(h.a,{color:"primary",variant:"contained",onClick:function(){d(!0),O.open(b).then((function(){f.push(p),d(!1)})).catch((function(){d(!1)}))},disabled:l,size:"large",children:"Proceed to game"})}),l&&Object(c.jsxs)(c.Fragment,{children:["Waiting for peer: ",Object(c.jsx)(z.a,{size:24})]})]})},Q=function(){var e=Object(a.useState)(!1),n=Object(s.a)(e,2),t=n[0],o=n[1],i=Object(j.f)(),r=Object(j.g)().gameID,l="/game/".concat(r),d=H();return Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Join to the SRRRABBBLE"}),Object(c.jsxs)("code",{children:["Game ID: ",r]}),Object(c.jsx)("p",{children:Object(c.jsx)(h.a,{variant:"contained",color:"primary",onClick:function(){o(!0),d.open(r).then((function(){i.push(l),o(!1)})).catch((function(){o(!1)}))},size:"large",disabled:t,children:"Join"})}),t&&Object(c.jsxs)(c.Fragment,{children:["Joining: ",Object(c.jsx)(z.a,{size:24})]})]})},U=(t(87),new Array(225).fill({}));var X=function(){return Object(c.jsx)("div",{className:"board",children:U.map((function(e,n){return Object(c.jsx)("div",{className:"cell"},n)}))})},Y=t(139),Z=t(136),$=t(141),ee=t(149),ne=t(140),te=(t(88),Object(Y.a)((function(e){return{root:{backgroundColor:e.palette.background.paper}}})));var ce=function(){var e=te(),n=H(),t=Object(a.useState)([]),o=Object(s.a)(t,2),i=o[0],r=o[1],l=function(e){r([e].concat(i.map((function(e){return e}))))};return Object(a.useEffect)((function(){n.onMessage(l),setTimeout((function(){n.sendMessage("".concat(n.user," joined"))}),1e3)}),[]),Object(c.jsx)("div",{className:"log",children:Object(c.jsx)(Z.a,{className:e.root,component:"nav","aria-label":"main mailbox folders",subheader:Object(c.jsx)(ne.a,{component:"div",children:"Logs:"}),children:i.map((function(e,n){return Object(c.jsx)($.a,{children:Object(c.jsx)(ee.a,{primary:e})},n)}))})})},ae=t(143),oe=t(144),ie=t(146),re=t(142),se=t(145),le=t(135);t(89);var je=function(){return Object(c.jsx)("div",{className:"scoreboard",children:Object(c.jsx)(re.a,{component:le.a,children:Object(c.jsx)(ae.a,{"aria-label":"simple table",size:"small",children:Object(c.jsxs)(oe.a,{children:[Object(c.jsxs)(se.a,{children:[Object(c.jsx)(ie.a,{component:"th",scope:"row",children:"Player #1 last score:"}),Object(c.jsx)(ie.a,{align:"right",children:"5"})]}),Object(c.jsxs)(se.a,{children:[Object(c.jsx)(ie.a,{component:"th",scope:"row",children:"Player #1 total score:"}),Object(c.jsx)(ie.a,{align:"right",children:"47"})]}),Object(c.jsxs)(se.a,{children:[Object(c.jsx)(ie.a,{component:"th",scope:"row",children:"Player #2 last score:"}),Object(c.jsx)(ie.a,{align:"right",children:"2"})]}),Object(c.jsxs)(se.a,{children:[Object(c.jsx)(ie.a,{component:"th",scope:"row",children:"Player #2 total score:"}),Object(c.jsx)(ie.a,{align:"right",children:"54"})]})]})})})})},de=(t(90),Object(Y.a)((function(e){return{btn:{margin:"0 2px"}}})));var be=function(){var e=de();return Object(c.jsxs)("div",{className:"controls",children:[Object(c.jsx)(h.a,{variant:"contained",size:"small",color:"primary",className:e.btn,children:"Submit"}),Object(c.jsx)(h.a,{variant:"contained",size:"small",color:"secondary",className:e.btn,children:"Pass"}),Object(c.jsx)(h.a,{variant:"contained",size:"small",className:e.btn,children:"Reset"}),Object(c.jsx)(h.a,{variant:"contained",size:"small",className:e.btn,children:"Swap"})]})},ue=function(){var e=Object(j.g)().gameID;return Object(c.jsxs)("div",{children:[Object(c.jsxs)("h1",{className:"title",children:["Game ID: ",e]}),Object(c.jsxs)("div",{className:"game",children:[Object(c.jsx)("div",{className:"main",children:Object(c.jsx)(X,{})}),Object(c.jsxs)("div",{className:"sidebar",children:[Object(c.jsx)(ce,{}),Object(c.jsx)(je,{}),Object(c.jsx)(be,{})]})]})]})};t(91);var he=function(){var e=Object(d.a)({palette:{type:"dark",primary:{light:"#ff7961",main:"#f44336",dark:"#ba000d",contrastText:"#fff"}}}),n=Object(a.useState)(),t=Object(s.a)(n,2),o=t[0],i=t[1];return Object(c.jsx)(l.a,{children:Object(c.jsx)(u.Provider,{value:{gameID:o,setGameID:i},children:Object(c.jsx)(G,{url:"wss://ice-server.app.html.wtf",children:Object(c.jsx)(b.a,{theme:e,children:Object(c.jsx)("div",{className:"app",children:Object(c.jsxs)(j.c,{children:[Object(c.jsx)(j.a,{path:"/create",children:Object(c.jsx)(y,{})}),Object(c.jsx)(j.a,{path:"/invite",children:Object(c.jsx)(K,{})}),Object(c.jsx)(j.a,{path:"/join/:gameID",children:Object(c.jsx)(Q,{})}),Object(c.jsx)(j.a,{path:"/game/:gameID",children:Object(c.jsx)(ue,{})}),Object(c.jsx)(j.a,{path:"/",children:Object(c.jsx)(O,{})})]})})})})})})},Oe=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,150)).then((function(n){var t=n.getCLS,c=n.getFID,a=n.getFCP,o=n.getLCP,i=n.getTTFB;t(e),c(e),a(e),o(e),i(e)}))};r.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(he,{})}),document.getElementById("root")),Oe()}},[[92,1,2]]]);
//# sourceMappingURL=main.c70e486c.chunk.js.map